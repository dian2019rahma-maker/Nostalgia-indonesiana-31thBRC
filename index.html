<!DOCTYPE html>
<html lang="id">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="UTF-8">
  <title>Registrasi Kehadiran - Nostalgia Indonesiana</title>
  <link rel="stylesheet" href="style.css">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Rye&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Agbalumo&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Neuton:wght@700&display=swap" rel="stylesheet">
</head>

<audio id="bg-music" autoplay loop muted hidden>
  <source src="assets/Lucky Draw BRC Jingle.mp3" type="audio/mp3">
</audio>

<!-- Tombol kontrol -->
<div id="music-toggle">üîá</div>

<script>
  const bgMusic = document.getElementById("bg-music");
  const toggleBtn = document.getElementById("music-toggle");

  // klik pertama di halaman ‚Üí unmute musik
  document.addEventListener("click", () => {
    bgMusic.muted = false;
    toggleBtn.textContent = "üîä";
  }, { once: true });

  // toggle manual mute/unmute
  toggleBtn.addEventListener("click", (e) => {
    e.stopPropagation(); // biar gak bentrok sama event global
    if (bgMusic.muted) {
      bgMusic.muted = false;
      toggleBtn.textContent = "üîä";
    } else {
      bgMusic.muted = true;
      toggleBtn.textContent = "üîá";
    }
  });
</script>

  <img src="assets/Orange.png" alt="floral" class="floral bottom-one">
  <img src="assets/Pink.png" alt="floral" class="floral bottom-two">
  <img src="assets/Mawar.png" alt="floral" class="floral bottom-three">
  <img src="assets/Orange.png" alt="floral" class="floral bottom-four">
  <img src="assets/Pink.png" alt="floral" class="floral bottom-five">
  <img src="assets/Mawar.png" alt="floral" class="floral bottom-six">

  <div class="checkerboard-left"></div>
  <div class="checkerboard-right"></div>
  <div class="container">
    <header>
      <img src="assets/upscalemedia-transformed.png" alt="Nostalgia Indonesiana" class="header-img">
      <p class="subtitle">Happy BRC 31st Anniversary & Staff Gathering 2025
      </p>
    </header>

    <section class="countdown">
      <h2>‚è≥ Menuju Acara</h2>
      <div id="timer">Loading...</div>
    </section>

    <main>
      <form id="regForm">
        <label for="noKaryawan">Masukkan Nomor Karyawan</label>
        <input type="text" id="noKaryawan" name="noKaryawan" required>
        <button type="submit" class="btn-konfirmasi">Konfirmasi Kehadiran</button>
      </form>
      <p id="errorMsg" class="error"></p>
    </main>
  </div>
  
    <!-- ================== SCRIPT AREA ================== -->
  <!-- 1. Tambahin PapaParse dulu -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>

  <!-- 2. Script custom kamu -->
  <script>
    let database = []; // nanti diisi dari Google Sheets

    // ambil data dari Google Sheets (publish to CSV link)
    Papa.parse("https://docs.google.com/spreadsheets/d/e/2PACX-1vSTGrrYmTg962xSYq5dwRhEq__8jwiakGj6vtOSgcdY1S-_wQ57bS7BB_ir5EelQlwKR--jpBGH3K4y/pub?output=csv", {
      download: true,
      header: true,
      skipEmptyLines: true,
      complete: function(results) {
        console.log("Raw results:", results)
        database = results.data;
        console.log("Data loaded:", database); // cek di console
      }
    });

    // Event form submit
    document.getElementById("regForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const id = document.getElementById("noKaryawan").value.trim();

      // Cari di database
      const found = database.find(row => row.NomorKaryawan === id);
      
      if (found) {
        const params = new URLSearchParams({
          nama: found.NamaKaryawan,
          kursi: found.NomorKursi
        });
        window.location.href = "konfirmasi.html?" + params.toString();
      } else {
        document.getElementById("errorMsg").textContent = "Nomor karyawan tidak ditemukan. Silakan cek kembali.";
      }
    });
  </script>

  <script>
    const eventDate = new Date("September 25, 2025 18:30:00").getTime();
    const timer = document.getElementById("timer");

    setInterval(function() {
      const now = new Date().getTime();
      const distance = eventDate - now;

      if (distance < 0) {
        timer.innerHTML = "üéâ Acara Sedang Berlangsung üéâ";
        return;
      }

      const days = Math.floor(distance / (1000 * 60 * 60 * 24));
      const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((distance % (1000 * 60)) / 1000);

      timer.innerHTML = `${days} Hari ${hours} Jam ${minutes} Menit ${seconds} Detik`;
    }, 1000);
  </script>

</script>
</body>
</html>
